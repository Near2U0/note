[TOC]

# 冗余链路

采用冗余拓扑结构保证了设备及链路故障时提供备份，从而不影响正常通信

![1567557176137](E:\git-workspace\note\images\computeNetwork\1567557176137.png)

存在桥接环路问题，桥接环路主要会产生广播风暴，单帧多次递交，MAC地址表失效等危害

![1567557266476](E:\git-workspace\note\images\computeNetwork\1567557266476.png)

# 生成树协议

生成树协议（spanning Tree Protocol, STP)是一个第二层数据链路层的管理协议，IEEE802委员会制定的生成树协议规范为802.1d,其目的是**将一个存在桥接环路的物理网络变成一个没有环路的逻辑树形网络**

![1567557817787](E:\git-workspace\note\images\computeNetwork\1567557817787.png)

* BPDU

  桥接协议数据单元

  在STP的工作过程中，交换机之间通过相互传递桥接协议数据单元BPDU获取各台交换机的参数信息，进而相互通信协商，将一个存在桥接环路的物理网络形成一个树形结构的逻辑网络

  ![1567557980820](E:\git-workspace\note\images\computeNetwork\1567557980820.png)

  ![1567558054138](E:\git-workspace\note\images\computeNetwork\1567558054138.png)

## STP的工作过程

* 选择根桥

  原则上所有交换机中桥ID（Bridge ID）最小的交换机作为生成树的根桥，桥ID是8个字节，包含了2个字节的桥优先级和6个字节的交换机MAC地址，在默认情况下，桥优先级都是32768，BPDU每隔2秒发送一次，桥ID最小的交换机将被选举为根桥

  ![1567558395524](E:\git-workspace\note\images\computeNetwork\1567558395524.png)

  **降低优先级可以指定根桥**

* 选择根端口

  原则是每台交换机的所有端口中，**到达根桥所花费的路径开销值最小的端口被确定为该交换机的根端口**

  ![1567558610248](E:\git-workspace\note\images\computeNetwork\1567558610248.png)

  ![1567558871136](E:\git-workspace\note\images\computeNetwork\1567558871136.png)

* 选择指定端口

  原则是每个网段中的所有端口中，到达根桥所花费的路径开销值为最小的端口被确定为该网段的指定端口

  ![1567559161100](E:\git-workspace\note\images\computeNetwork\1567559161100.png)

* 决定非指定端口

  既不是根端口，也不是指定端口的端口将成为非指定端口

31：00

