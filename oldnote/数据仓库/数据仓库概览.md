[toc]



![](../../images/data-warehouse/image-20200615175921248.png)



# 项目需求

数据采集平台搭建

用户行为数据仓库的分层搭建

数据的基本处理：留存、转化率、GMV，复购率、PV，UV等报表分析（SQL）

# 思考

## 1.项目技术如何选型？

   * 数据采集传输：Flume，Kafka(日志采集)， Sqoop(用于关系型数据库)，Logstash, DataX(用于关系型数据库)
   * 数据存储：MySQL（可视化），HDFS（离线数据）， HBase，Redis， MongoDB，ES
   * 数据计算：Hive， Tez（作为hive的执行引擎），Spark，Flink， Storm（实时会用到）
   * 数据查询（即席查询）：Presto，Druid，Impala， Kylin

## 2.框架版本如何选型？

   Apache 原生： 

   ​	运维麻烦（需要一个一个组件的搭建）

   ​	组件之间的兼容性需要自己去解决（一般大厂使用，技术实力雄厚，有专业的运维人员）

| 产品      | 版本     |
| --------- | -------- |
| Hadoop    | 2.7.2    |
| Flume     | 1.7.0    |
| Kafka     | 0.11.0.2 |
| Hive      | 1.2.1    |
| Sqoop     | 1.4.6    |
| MySQL     | 5.6.24   |
| Azkaban   | 2.5.0    |
| Java      | 1.8      |
| Zookeeper | 3.4.10   |
| Presto    | 0.189    |
| Hbase     | 1.3.1    |


   CDH：

   ​	商用，国内使用最多的版本，但CM不开源，但其实对中小型公司的使用来说没有影响（建议使用）

   ​	部署简单，解决了框架（组件）的兼容性，CDH 自身有一个版本号

   ​	WEB页面的某些功能是不开源的

   ​	

| 产品CDH框架版本：5.12.1 | 版本  |
| ----------------------- | ----- |
| Hadoop                  | 2.6.0 |
| Spark                   | 1.6.0 |
| Flume                   | 1.6.0 |
| Hive                    | 1.1.0 |
| Sqoop                   | 1.4.6 |
| Ooize                   | 4.1.0 |
| Zookeeper               | 3.4.5 |
| Impala                  | 2.9.0 |
| Hbase                   | 1.3.1 |

   HDP：没有CDH稳定

   ![image-20200616175209404](C:/Users/landun/AppData/Roaming/Typora/typora-user-images/image-20200616175209404.png)

## 3.服务器使用的**物理机**还是**云主机**？

1. 机器成本考虑：

   物理机：以128G内存（内存一定要大，spark，flink），20核物理CPU，40线程，至强E5，8THDD（机械） 2TSSD（固态）硬盘（如果资金充足，那么8TSSD也是可以的），戴尔，华为，单台报价4W多，

   需要考虑托管服务器费用（没有自己的机房，第三方的公司托管，提供网络等服务，一年1W（跟提供的带宽有关）），一般物理机的寿命5年左右（可能会出现问题）

   云主机：以阿里云为例：上面的相同配置，每年5W，这样一比，还是云主机更贵，但是云主机方便，不需要提供专门的运维，服务器的使用时间也是灵活的（不一定用5年）

2. 运维成本考虑：

   物理机：需要有专业的运维人员

   云主机：很多的运维工作都可以由阿里云完成，运维相对较轻松

   综合：物理机和云主机是差不多成本，我自身是倾向于云主机

3. 如何确认集群规模（假设每台服务器8T硬盘，128G内存）

   根据一天的数据量，要保存多少天的数据，确定集群规模（需要多少台服务器，每台服务器的配置）

   假设，数仓的数据至少保存6个月











to do list

1. dataX 使用
2. 实时：spark， flink
3. 即席查询：Impala
4. SQL调优（很重要）



