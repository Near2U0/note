[TOC]





# 1.文件描述符的概念

## 1.1.简要描述

在wiki中是这样解释的：**文件描述符**（File descriptor）是计算机科学中的一个术语，是一个用于表述指向文件的引用的抽象化概念。文件描述符在形式上是一个非负整数。实际上，它是一个索引值，指向内核为每一个进程所维护的该进程打开文件的记录表。当程序打开一个现有文件或者创建一个新文件时，**内核向进程返回一个文件描述符**  





## 1.2.代码描述



```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <fcntl.h>

int main (void){
    int fd;
    int numbytes;
    char path[] = "file";
    char buf[256];

    /*
     * O_CREAT:如果文件不存在则创建
     * O_RDONLY:以只读模式打开文件
     * 返回的就是一个文件描述符，这个文件描述符代表的就是这个文件的引用
     */
    fd = open(path, O_CREAT | O_RDONLY, 0644);
    if(fd < 0){
        perror("open()");
        exit(EXIT_FAILURE);
    }

    memset(buf, 0x00, 256);
    while((numbytes = read(fd, buf, 255)) > 0){//对这个文件描述符进行读操作
        printf("%d bytes read: %s", numbytes, buf);
        memset(buf, 0x00, 256);
    }
    close (fd);
    exit(EXIT_SUCCESS);
}
```



# 2.文件描述符图解

在[Linux通用I/O模型](https://www.jianshu.com/p/5357d72ef17d)中，`I/O`操作系列函数(系统调用)都是围绕一个叫做文件描述符的整数展开。这不禁让人产生疑问：这个整数代表什么？一个数值代表一个文件吗？随便传一个整数进去调用可以吗？ 







# 3.标准输出，错误输出和文件描述符的关系



每个Unix进程（除了可能的[守护进程](https://zh.wikipedia.org/wiki/%E5%AE%88%E6%8A%A4%E8%BF%9B%E7%A8%8B)）应均有三个标准的[POSIX](https://zh.wikipedia.org/wiki/POSIX)文件描述符，对应于三个标准流：

| 整数值 | 名称    | 符号常量      | 文件流 |
| ------ | ------ | ------------- | ------ |
| 0      | Standard input | STDIN_FILENO  | stdin  |
| 1      | Standard output | STDOUT_FILENO | stdout |
| 2      | Standard error | STDERR_FILENO | stderr |



* /dev/null 文件

如果希望执行某个命令，但又不希望在屏幕上显示输出结果，那么可以将输出重定向到 /dev/null：

```
#注意：0 是标准输入（STDIN），1 是标准输出（STDOUT），2 是标准错误输出（STDERR）
$ command > /dev/null 2>&1

标准输入的文件描述符为：0	
标准输出的文件描述符为：1	也就是 /dev/null的句柄
标准错误输出的文件描述符为：2

所以2 > &1 表示的是将错误的输出定位到标准输出中
```

