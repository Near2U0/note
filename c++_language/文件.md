[TOC]

文件数据的组织形式

* 文本文件
* 二进制文件

# 文件句柄的理解

* 缓冲文件系统：高级文件系统，系统自动为正在使用的文件开辟内存缓冲区

* 非缓冲文件系统：低级文件系统，由用户在程序中为每个文件设定缓冲区

![simg](E:\git-workspace\note\images\c++\filehandler2.jpg)

缓冲文件系统理解：文件句柄

![img](E:\git-workspace\note\images\c++\file_handler.jpg)


# 按照字符读写文件

```c

void main01(void)
{
    FILE *fp = NULL;
    char *filname = "/tmp/test.txt";// c:\\test.txt 也是可以的，但是建议统一使用45度
    char a[27] = "abcdefg";
    int i;
    
    fp = fopen(filenmae, "r+");//读写方式打开,文件需要存在
    if(fp == NULL)
    {
        printf("fopen fail");
        return;
    }
    
    printf("file open success\n");
    
    for(i=0; i<strlen(a); i++)
    {
        fputc(a[i], fp);
    }
    
    if(fp != NULL)
    {
        fclose(fp);
    }
}

void main(void)
{
    FILE *fp = NULL;
    char *filname = "/tmp/test.txt";// c:\\test.txt 也是可以的，但是建议统一使用45度
    int i;
    char c;
    
    fp = fopen(filenmae, "r+");//读写方式打开,文件需要存在
    if(fp == NULL)
    {
        printf("fopen fail");
        return;
    }
    
    printf("file open success\n");
    
    while(!feof(fp))
    {
        char tmpc = fgetc(fp);
        printf("%c", tmpc);
    }
    if(fp != NULL)
    {
        fclose(fp);
    }
    
}
```

# 按照行方式读写文件

```c
char *mygets(char *myp, int max, FILE *fp)
{
    strcpy(myp, "aaaa");
    return myp;
}

void main01(void)
{
    FILE *fp = NULL;
    char *filname = "/tmp/test.txt";// c:\\test.txt 也是可以的，但是建议统一使用45度
    char a[27] = "abcdefg";
    int i;
    
    fp = fopen(filenmae, "r+");//读写方式打开,文件需要存在
    if(fp == NULL)
    {
        printf("fopen fail");
        return;
    }
    
    printf("file open success\n");
    
    //一次写入一行
    fputs(a, fp);
    
    //一次get一行
    while(!feof(fp))
    {
        //返回的就是buf的首地址
        char *p = fgets(buf, 1024, fp);
        //C函数库会一行一行的copy数据到buf指针所指的内存空间中，并且变成C风格的字符串(加上\0,加上\n)
        if(p == NULL)
        {
            return;
        }
        printf("%s", buf);
    }
    
    
    if(fp != NULL)
    {
        fclose(fp);
    }
}
```







